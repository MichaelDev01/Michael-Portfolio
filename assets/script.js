const translations = {
    en: {
        "nav.about": "About",
        "nav.experience": "Experience",
        "nav.projects": "Projects",
        "nav.skills": "Skills",
        "nav.contact": "Contact",
        "hero.eyebrow": "Full Stack .NET Developer",
        "hero.title": "Building resilient enterprise systems and polished product experiences.",
        "hero.subtitle": "I design and deliver secure, data-driven platforms that scale - blending deep .NET expertise with cloud-native architecture and a collaborative mindset.",
        "hero.cta.primary": "View Featured Work",
        "hero.cta.secondary": "Let's Collaborate",
        "hero.card1.title": "End-to-End Delivery",
        "hero.card1.body": "From architecture to deployment, I modernize legacy ecosystems and launch greenfield initiatives with measurable impact.",
        "hero.card2.title": "Cloud & Data Focused",
        "hero.card2.body": "Azure, AWS, SQL Server, and Service Broker expertise ensure secure integrations, optimized performance, and maintainable codebases.",
        "hero.card3.title": "Bilingual Leadership",
        "hero.card3.body": "Fluent in English and Spanish, I bridge technical teams and stakeholders across global initiatives.",
        "portrait.eyebrow": "Human Touch",
        "portrait.title": "Putting a face to the code.",
        "portrait.caption": "Michael Villa, Full Stack .NET Developer",
        "portrait.body": "Technology enthusiast and avid coder with a passion for emerging technologies, gaming, and problem-solving through programming. Regularly explore advancements in software development and their applications in real-world scenarios.",
        "about.eyebrow": "Profile",
        "about.title": "Strategic technologist delivering secure, scalable solutions.",
        "about.body": "With over a decade architecting enterprise platforms, I combine software craftsmanship with a strong business lens. I thrive in highly regulated environments, modernizing .NET systems, streamlining data flows, and mentoring teams to deliver resilient solutions.",
        "about.point1": "Polyglot developer comfortable across C#, VB.NET, SQL, JavaScript, and modern frontend frameworks.",
        "about.point2": "Experienced in global deployments, hybrid cloud, and performance-sensitive integrations.",
        "about.point3": "Business-savvy collaborator who translates complex requirements into actionable roadmaps.",
        "experience.eyebrow": "Experience",
        "experience.title": "Leading mission-critical initiatives across finance, healthcare, and SaaS.",
        "experience.item1.date": "Feb 2025 - Present",
        "experience.item1.body": "Senior .NET consultant designing high-availability routing platforms, modernizing APIs, and orchestrating SQL Server messaging at global scale.",
        "experience.item1.point1": "Built REST APIs across .NET 4.x and .NET 8 with automated test suites.",
        "experience.item1.point2": "Optimized Service Broker pipelines to reduce latency between branch and central systems.",
        "experience.item1.point3": "Enhanced WPF dashboards with data visualizations for field operations.",
        "experience.item2.date": "May 2023 - Jan 2025",
        "experience.item2.body": "Delivered secure web platforms, data integrations, and identity migrations for healthcare compliance solutions.",
        "experience.item2.point1": "Migrated enterprise SSO from PING to Okta and led Azure DevOps release pipelines.",
        "experience.item2.point2": "Extended Entity Framework data layers to support evolving client workflows.",
        "experience.item2.point3": "Designed XML-driven integrations and utilities that automated client operations.",
        "experience.item3.date": "Sep 2019 - Mar 2023",
        "experience.item3.body": "Architected global cash logistics platforms, integrating third-party devices, APIs, and analytics capabilities.",
        "experience.item3.point1": "Led system integrations across vendor ecosystems with secure data exchanges.",
        "experience.item3.point2": "Optimized SQL Server performance and infrastructure planning.",
        "experience.item3.point3": "Facilitated cross-functional delivery with distributed teams.",
        "experience.item4.date": "2013 - 2019",
        "experience.item4.body": "Engineer and consultant delivering WinForms, WPF, and VB.NET solutions, modernizing legacy stacks and automating data pipelines.",
        "experience.item4.point1": "Modernized VB.NET systems to C# at ECi Software Solutions.",
        "experience.item4.point2": "Built SSRS analytics and ETL processes for healthcare clients at BCBSTX.",
        "experience.item4.point3": "Developed GIS-integrated ETL services for environmental research at TAMIU.",
        "projects.eyebrow": "Featured Projects",
        "projects.title": "Showcasing platforms that blend robust engineering with refined UX.",
        "projects.project1.role": "Lead Full Stack Developer",
        "projects.project1.body": "Produced AnaLiliaVilla.com, a procurement portfolio with KPI spotlights, animated milestones, and theme-aware storytelling that elevates her LEGO program leadership for executive recruiters.",
        "projects.project2.role": "Solutions Architect",
        "projects.project2.body": "Orchestrated a global cash logistics platform, synchronizing route telemetry, device diagnostics, and KPI dashboards across secure SQL Server clusters.",
        "projects.project2.link": "Case Study Coming Soon",
        "projects.project3.role": "Senior .NET Developer",
        "projects.project3.body": "Delivered configurable compliance workflows with single sign-on, audit-ready reporting, and multi-tenant provisioning for healthcare networks.",
        "projects.project3.link": "View Prototype",
        "skills.eyebrow": "Expertise",
        "skills.title": "Technical breadth anchored in enterprise delivery.",
        "skills.column1": "Core Engineering",
        "skills.column2": "Data & Cloud",
        "skills.column3": "Collaboration",
        "contact.eyebrow": "Let's Connect",
        "contact.title": "Ready to discuss complex systems or new product ideas?",
        "contact.cta": "Get in Touch",
        "contact.body": "I am available for consulting engagements, leadership roles, and high-impact build-outs. Share your challenge - let's explore the solution together.",
        "contact.location": "Fort Worth, Texas",
        "contact.actions.email": "Email Michael",
        "contact.actions.linkedin": "Connect on LinkedIn",
        "contact.form.nameLabel": "Name",
        "contact.form.emailLabel": "Email",
        "contact.form.messageLabel": "Project Details",
        "contact.form.submit": "Send Message",
        "footer.rights": "All rights reserved."
    },
    es: {
        "nav.about": "Perfil",
        "nav.experience": "Experiencia",
        "nav.projects": "Proyectos",
        "nav.skills": "Habilidades",
        "nav.contact": "Contacto",
        "hero.eyebrow": "Desarrollador Full Stack .NET",
        "hero.title": "Construyendo sistemas empresariales resilientes y experiencias de producto pulidas.",
        "hero.subtitle": "Diseño y entrego plataformas seguras, impulsadas por datos y listas para escalar, combinando un profundo dominio de .NET con arquitectura nativa en la nube y una mentalidad colaborativa.",
        "hero.cta.primary": "Ver trabajo destacado",
        "hero.cta.secondary": "Colaboremos",
        "hero.card1.title": "Entrega de extremo a extremo",
        "hero.card1.body": "Desde la arquitectura hasta el despliegue, modernizo ecosistemas heredados y lanzo iniciativas greenfield con impacto medible.",
        "hero.card2.title": "Enfoque en la nube y datos",
        "hero.card2.body": "La experiencia en Azure, AWS, SQL Server y Service Broker garantiza integraciones seguras, rendimiento optimizado y bases de código mantenibles.",
        "hero.card3.title": "Liderazgo bilingüe",
        "hero.card3.body": "Fluido en inglés y español, conecto equipos técnicos y stakeholders en iniciativas globales.",
        "portrait.eyebrow": "Toque humano",
        "portrait.title": "Poniendo rostro al código.",
        "portrait.caption": "Michael Villa, Desarrollador Full Stack .NET",
        "portrait.body": "Entusiasta de la tecnología y programador ávido con pasión por las tecnologías emergentes, los videojuegos y la resolución de problemas a través de la programación. Exploro regularmente los avances en el desarrollo de software y sus aplicaciones en escenarios del mundo real.",
        "about.eyebrow": "Perfil",
        "about.title": "Tecnólogo estratégico que entrega soluciones seguras y escalables.",
        "about.body": "Con más de una década diseñando plataformas empresariales, combino artesanía de software con una sólida perspectiva de negocio. Prosperé en entornos altamente regulados, modernizando sistemas .NET, agilizando flujos de datos y guiando equipos para entregar soluciones resilientes.",
        "about.point1": "Desarrollador políglota cómodo con C#, VB.NET, SQL, JavaScript y frameworks modernos de frontend.",
        "about.point2": "Experiencia en despliegues globales, nube híbrida e integraciones sensibles al rendimiento.",
        "about.point3": "Colaborador con visión de negocio que traduce requisitos complejos en hojas de ruta accionables.",
        "experience.eyebrow": "Experiencia",
        "experience.title": "Liderando iniciativas críticas en finanzas, salud y SaaS.",
        "experience.item1.date": "Feb 2025 - Presente",
        "experience.item1.body": "Consultor senior .NET que diseña plataformas de enrutamiento de alta disponibilidad, moderniza APIs y orquesta mensajería de SQL Server a escala global.",
        "experience.item1.point1": "Construí APIs REST en .NET 4.x y .NET 8 con suites de pruebas automatizadas.",
        "experience.item1.point2": "Optimicé canalizaciones de Service Broker para reducir la latencia entre sucursales y sistemas centrales.",
        "experience.item1.point3": "Mejoré tableros WPF con visualizaciones de datos para operaciones de campo.",
        "experience.item2.date": "May 2023 - Ene 2025",
        "experience.item2.body": "Entregué plataformas web seguras, integraciones de datos y migraciones de identidad para soluciones de cumplimiento sanitario.",
        "experience.item2.point1": "Migré el SSO empresarial de PING a Okta y dirigí pipelines de despliegue en Azure DevOps.",
        "experience.item2.point2": "Extendí capas de datos de Entity Framework para respaldar flujos de trabajo en evolución.",
        "experience.item2.point3": "Diseñé integraciones y utilidades basadas en XML que automatizaron operaciones de clientes.",
        "experience.item3.date": "Sep 2019 - Mar 2023",
        "experience.item3.body": "Arquitecté plataformas globales de logística de efectivo, integrando dispositivos de terceros, APIs y capacidades analíticas.",
        "experience.item3.point1": "Lideré integraciones de sistemas entre ecosistemas de proveedores con intercambios de datos seguros.",
        "experience.item3.point2": "Optimicé el rendimiento de SQL Server y la planificación de infraestructura.",
        "experience.item3.point3": "Facilité la entrega multifuncional con equipos distribuidos.",
        "experience.item4.date": "2013 - 2019",
        "experience.item4.body": "Ingeniero y consultor entregando soluciones WinForms, WPF y VB.NET, modernizando stacks heredados y automatizando canalizaciones de datos.",
        "experience.item4.point1": "Modernicé sistemas VB.NET a C# en ECi Software Solutions.",
        "experience.item4.point2": "Construí analítica SSRS y procesos ETL para clientes de salud en BCBSTX.",
        "experience.item4.point3": "Desarrollé servicios ETL integrados con GIS para investigación ambiental en TAMIU.",
        "projects.eyebrow": "Proyectos destacados",
        "projects.title": "Mostrando plataformas que combinan ingeniería robusta con UX refinada.",
        "projects.project1.role": "Líder desarrollador Full Stack",
        "projects.project1.body": "Produje AnaLiliaVilla.com, un portafolio de procurement con indicadores clave, hitos animados y narrativa sensible al tema que resalta su liderazgo en programas LEGO ante reclutadores ejecutivos.",
        "projects.project2.role": "Arquitecto de soluciones",
        "projects.project2.body": "Orquesté una plataforma global de logística de efectivo, sincronizando telemetría de rutas, diagnósticos de dispositivos y tableros KPI en clústeres seguros de SQL Server.",
        "projects.project2.link": "Estudio de caso próximamente",
        "projects.project3.role": "Desarrollador senior .NET",
        "projects.project3.body": "Entregué flujos de trabajo de cumplimiento configurables con single sign-on, reportes auditables y aprovisionamiento multi-tenant para redes de salud.",
        "projects.project3.link": "Ver prototipo",
        "skills.eyebrow": "Experiencia",
        "skills.title": "Amplitud técnica anclada en la entrega empresarial.",
        "skills.column1": "Ingeniería principal",
        "skills.column2": "Datos y nube",
        "skills.column3": "Colaboración",
        "contact.eyebrow": "Conectemos",
        "contact.title": "¿Listo para hablar de sistemas complejos o nuevas ideas de producto?",
        "contact.cta": "Ponte en contacto",
        "contact.body": "Estoy disponible para consultorías, roles de liderazgo y proyectos de alto impacto. Comparte tu reto y exploremos la solución juntos.",
        "contact.location": "Fort Worth, Texas",
        "contact.actions.email": "Enviar correo a Michael",
        "contact.actions.linkedin": "Conectar en LinkedIn",
        "contact.form.nameLabel": "Nombre",
        "contact.form.emailLabel": "Correo",
        "contact.form.messageLabel": "Detalles del proyecto",
        "contact.form.submit": "Enviar mensaje",
        "footer.rights": "Todos los derechos reservados."
    }
};

const languageButtons = document.querySelectorAll('.lang-button');
const i18nElements = document.querySelectorAll('[data-i18n]');
const themeToggle = document.getElementById('themeToggle');
const themeIcon = document.querySelector('.theme-icon');
const body = document.body;
const menuToggle = document.querySelector('.menu-toggle');
const siteNav = document.getElementById('primary-navigation');
const navLinks = siteNav ? siteNav.querySelectorAll('a') : [];
const mobileNavMq = window.matchMedia('(max-width: 720px)');

if (menuToggle && siteNav) {
    const setNavVisibility = (isVisible) => {
        siteNav.dataset.visible = String(isVisible);
        menuToggle.setAttribute('aria-expanded', String(isVisible));
    };

    menuToggle.addEventListener('click', () => {
        const isOpen = menuToggle.getAttribute('aria-expanded') === 'true';
        setNavVisibility(!isOpen);
    });

    navLinks.forEach((link) => {
        link.addEventListener('click', () => {
            if (mobileNavMq.matches) {
                setNavVisibility(false);
            }
        });
    });

    document.addEventListener('click', (event) => {
        if (!mobileNavMq.matches) return;
        if (menuToggle.contains(event.target) || siteNav.contains(event.target)) return;
        if (menuToggle.getAttribute('aria-expanded') === 'true') {
            setNavVisibility(false);
        }
    });

    mobileNavMq.addEventListener('change', (event) => {
        if (!event.matches) {
            setNavVisibility(false);
        }
    });
}

const preferredTheme = window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
const storedTheme = localStorage.getItem('mv-theme');
const currentTheme = storedTheme || preferredTheme;

setTheme(currentTheme === 'light');

if (themeToggle) {
    themeToggle.addEventListener('click', () => {
        const isLight = body.dataset.theme !== 'light';
        setTheme(isLight);
        localStorage.setItem('mv-theme', isLight ? 'light' : 'dark');
    });
}

function setTheme(isLight) {
    if (isLight) {
        body.dataset.theme = 'light';
        if (themeIcon) {
            themeIcon.textContent = 'Dark';
        }
    } else {
        body.dataset.theme = 'dark';
        if (themeIcon) {
            themeIcon.textContent = 'Light';
        }
    }

    initParticlesBackground();
}

let activeLanguage = localStorage.getItem('mv-lang') || 'en';
applyTranslations(activeLanguage);
updateLanguageButtons(activeLanguage);

languageButtons.forEach((button) => {
    button.addEventListener('click', () => {
        const { lang } = button.dataset;
        if (!lang || lang === activeLanguage || !translations[lang]) return;
        activeLanguage = lang;
        applyTranslations(lang);
        updateLanguageButtons(lang);
        localStorage.setItem('mv-lang', lang);
    });
});

function applyTranslations(lang) {
    const dictionary = translations[lang];
    if (!dictionary) return;

    i18nElements.forEach((element) => {
        const key = element.dataset.i18n;
        if (!key) return;
        const value = dictionary[key];
        if (typeof value === 'string') {
            element.textContent = value;
        }
    });
}

function updateLanguageButtons(lang) {
    languageButtons.forEach((button) => {
        button.classList.toggle('active', button.dataset.lang === lang);
    });
}

const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
        }
    });
}, { threshold: 0.2 });

document.querySelectorAll('[data-animate]').forEach((element) => observer.observe(element));

const yearElement = document.getElementById('year');
if (yearElement) {
    yearElement.textContent = new Date().getFullYear();
}

const contactForm = document.querySelector('.contact-form');
if (contactForm) {
    contactForm.addEventListener('submit', (event) => {
        event.preventDefault();
        contactForm.reset();
        const submitButton = contactForm.querySelector('button[type="submit"]');
        if (!submitButton) return;
        submitButton.textContent = activeLanguage === 'es' ? 'Enviado' : 'Sent';
        setTimeout(() => {
            const key = 'contact.form.submit';
            const dictionary = translations[activeLanguage];
            if (dictionary && dictionary[key]) {
                submitButton.textContent = dictionary[key];
            }
        }, 2400);
    });
}

initParticlesBackground();

function initParticlesBackground() {
    const container = document.getElementById('particles-js');
    if (!container || typeof window.particlesJS !== 'function') {
        console.warn('Particles.js library is missing. Background animation skipped.');
        return;
    }

    if (window.pJSDom && window.pJSDom.length > 0) {
        window.pJSDom.forEach((instance) => {
            instance?.pJS?.fn?.vendors?.destroypJS();
        });
        window.pJSDom = [];
    }

    const styles = getComputedStyle(document.documentElement);
    const accent = styles.getPropertyValue('--accent').trim() || '#79b8ff';
    const accentStrong = styles.getPropertyValue('--accent-strong').trim() || accent;
    const isLightTheme = body.dataset.theme === 'light';
    const secondaryAccent = isLightTheme ? '#6f8fff' : accentStrong;
    const softAccent = isLightTheme ? '#d5e4ff' : '#ffffff';
    const linkColor = isLightTheme ? '#6a80ff' : accent;
    const linkOpacity = isLightTheme ? 0.22 : 0.35;
    const particleOpacity = isLightTheme ? 0.45 : 0.65;
    const lineWidth = isLightTheme ? 0.8 : 1;
    const grabLinkOpacity = isLightTheme ? 0.45 : 0.55;

    window.particlesJS('particles-js', {
        particles: {
            number: {
                value: 110,
                density: {
                    enable: true,
                    value_area: 900
                }
            },
            color: {
                value: [accent, secondaryAccent, softAccent]
            },
            shape: {
                type: 'circle'
            },
            opacity: {
                value: particleOpacity,
                random: true
            },
            size: {
                value: 3.6,
                random: true
            },
            line_linked: {
                enable: true,
                distance: 140,
                color: linkColor,
                opacity: linkOpacity,
                width: lineWidth
            },
            move: {
                enable: true,
                speed: 1.4,
                direction: 'none',
                random: true,
                out_mode: 'out'
            }
        },
        interactivity: {
            detect_on: 'canvas',
            events: {
                onhover: {
                    enable: true,
                    mode: 'grab'
                },
                onclick: {
                    enable: true,
                    mode: 'push'
                },
                resize: true
            },
            modes: {
                grab: {
                    distance: 140,
                    line_linked: {
                        opacity: grabLinkOpacity
                    }
                },
                push: {
                    particles_nb: 3
                }
            }
        },
        retina_detect: true
    });
}
